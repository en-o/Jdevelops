> spring boot mvc çš„å…¨å±€å¼‚å¸¸æ•è·ï¼Œä¾èµ–ä¸‹æ³¨è§£å³å¯

# ä¾èµ–
```xml
<dependency>
    <groupId>cn.tannn.jdevelops</groupId>
    <artifactId>jdevelops-apis-exception</artifactId>
    <version>0.0.1-SNAPSHOT</version>
</dependency>
```
# å¼‚å¸¸æ ¼å¼
## é»˜è®¤æ ¼å¼
> [ğŸ¥±æ¥å£åŒ…è£¹ç±»](https://www.yuque.com/tanning/yg9ipo/qcyw5934uv8ga089?view=doc_embed&inner=qOdGH) - å¸¸è§„è¿”å›

```java
{
  "code": 501,
  "message": "/ by zero",
  "ts": 1715243347618,
  "data": null,
  "success": false
}
```
## é‡ç½®æ ¼å¼
[ğŸ¥±æ¥å£åŒ…è£¹ç±»](https://www.yuque.com/tanning/yg9ipo/qcyw5934uv8ga089?view=doc_embed&inner=nCRFY) - é‡ç½®é»˜è®¤åŒ…è£¹ç±»

# å¼‚å¸¸é…ç½®
```properties
# å…³é—­å…¨å±€å¼‚å¸¸å¤„ç† - é»˜è®¤å€¼ä¸ºtrue
jdevelops.exception.enabled=false
# å¼‚å¸¸æ ˆæ˜¯å¦æ‰“å°ï¼ˆé»˜è®¤ä¸ºtrueæ‰“å°ï¼‰
jdevelops.exception.log-input=true
# æ˜¯å¦å°†è‡ªå®šçš„å¼‚å¸¸codeæ”¾åˆ°ï¼šresponse status ä¸­å»ï¼ˆé»˜è®¤ä¸æ”¾ï¼‰
jdevelops.exception.http-servlet-response-status=true
# è®¾ç½®å¼‚å¸¸ä¿¡æ¯è¿”å›çš„ header ç§çš„ content type ä¸€èˆ¬ä¸ä½¿ç”¨ï¼Œç”¨é»˜è®¤çš„å°±è¡Œäº†
# jdevelops.exception.http-servlet-response-header-content-type=
```

# æ„å»ºæ–°çš„å¼‚å¸¸ç±»

1. å¼‚å¸¸ç»§æ‰¿ **BusinessException** æ‰èƒ½è‡ªå®šä¹‰è¿”å›çš„code,å¦åˆ™åªä¼šä½¿ç”¨é»˜è®¤å€¼ `501`
```java

/**
 * jwtå¼‚å¸¸
 *
 * @author tnnn
 * @version V1.0
 * @date 2022-12-28 09:33
 */
public class TokenException extends BusinessException{
    public TokenException(int code, String message) {
        super(code, message);
    }

    public TokenException(String message) {
        super(message);
    }
    public TokenException(String message, Throwable cause) {
        super(message, cause);
    }

    public TokenException(ExceptionCode constantEnum) {
        super(constantEnum.getCode(), constantEnum.getMessage());
    }

}

```

2. å¦‚æœä¸ç»§æ‰¿ **BusinessException **ä½†æ˜¯æƒ³ç”¨åˆ°è‡ªå®šä¹‰çš„codeå°±å¿…é¡»ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•`specialMessage`æ„é€ ä¸€ä¸ª `code <=====> message`çš„ messageå­—ç¬¦ä¸²æˆ‘ä¼šåœ¨ `ExceptionResultWrap._result_`ä¸­åšè§£æã€‚
```java
/**
 * æ¥å£å¹‚ç­‰å¼‚å¸¸
 *
 * @author tnnn
 * @version V1.0
 * @date 2022-11-17 15:02
 */
public class IdempotentException  extends RuntimeException{
    /**
     * ResultCode.API_DOUBLE_CALL
     */
    public static int IDEMPOTENT_CODE = 602;
    public static String SYMBOL  = "<=====>";

    public IdempotentException() {
        super();
    }

    /**
     * ç‰¹çš„message
     *   <ps>ç”¨äºæ— æ³•ä½¿ç”¨BusinessExceptionï¼Œå½“æ—¶æƒ³è‡ªå®šä¹‰å¤±è´¥codeçš„æƒ…å†µï¼ˆé»˜è®¤æ˜¯501ï¼‰</ps>
     * @param message message
     * @return code+ ExceptionResultWrap.symbol+message; (eg. 200<=====>ä½ é”™äº†)
     */
    public static IdempotentException specialMessage(String message){
        return new IdempotentException(IDEMPOTENT_CODE + SYMBOL + message);
    }


}

```
# å†…ç½®å¼‚å¸¸ç±»

1. BusinessException
> **æœ€å¤§çš„å†…ç½®å¼‚å¸¸ï¼Œæ‰€æœ‰æ–°å»ºå¼‚å¸¸éƒ½å¿…é¡»ç»§æ‰¿ä»–**

2. DataConflictException
> æ•°æ®å†²çªå¼‚å¸¸

3. LoginLimitException
> ç™»å½•é™åˆ¶å¼‚å¸¸

4. TokenException
> tokenç›¸å…³å¼‚å¸¸

5. UserException
> ç”¨æˆ·ç›¸å…³å¼‚å¸¸


# å·²å¤„ç†çš„å¼‚å¸¸
## ğŸ˜±Exception
> ä¸‹é¢å¤„ç†ä¸åˆ°çš„å¼‚å¸¸éƒ½ä¼šèµ°è¿™ä¸ªè¿›è¡Œè¿”å›ç»™å‰ç«¯

## ğŸ˜±BusinessException
> æˆ‘ä»¬è‡ªå®šä¹‰çš„å¼‚å¸¸

## ğŸ˜±NoHandlerFoundException
> 404 ç›¸å…³çš„å¼‚å¸¸ -> è·¯å¾„ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥è·¯å¾„æ˜¯å¦æ­£ç¡®

## ğŸ˜±NullPointerException
> ç©ºæŒ‡é’ˆå¼‚å¸¸ -> æš‚æ—¶æ— æ³•è·å–æ•°æ®

## ğŸ˜±HttpRequestMethodNotSupportedException
> è¯·æ±‚æ–¹å¼ä¸å¯¹ - get post

## ğŸ˜±HttpMessageNotReadableException
> å‚æ•°é”™è¯¯ -> è¯·æ±‚å‚æ•°æ ¼å¼é”™è¯¯,è¯·æ£€æŸ¥ã€‚é”™è¯¯æ¶ˆæ¯(æ¶ˆæ¯ä¸å¯è¯»)

## ğŸ˜±MethodArgumentNotValidException
> å‚æ•°éªŒè¯å¼‚å¸¸ -> javax.validation

## ğŸ˜±RuntimeException
> è¿è¡Œæ—¶å¼‚å¸¸

## ğŸ˜±BindException
> å‚æ•°éªŒè¯å¼‚å¸¸ -> springframework.validation


# âŒ`@DisposeException`æ•æ‰æ–¹æ³•å’Œç±»å¼‚å¸¸
> 1. æœ‰äº›é”™è¯¯çš„æŠ›å‡ºéœ€è¦è¿›è¡Œè‡ªè¡Œæ•æ‰ï¼Œå†™çƒ¦äº†å°±ç”¨äº†AOPè¿›è¡Œäº†æ•æ‰ï¼Œæ¯”å¦‚æ•°æ®é‡å¤æŠ›å‡ºçš„å¼‚å¸¸å°±å¯ä»¥ç”¨è¿™ä¸ªæŠ›å‡ºä¸ªmessageå«æ•°æ®å·²å­˜åœ¨è¯·å‹¿é‡å¤æ·»åŠ 
> 2. [å¼‚å¸¸æ ¼å¼](#a7RC6)

## æ–¹æ³•åˆ©ç”¨
```java
@DisposeException(messages ="é”™è¯¯çš„é›¶", 
codes = 500, 
exceptions = ArithmeticException.class )
public ResultVO<String>  test1(){
  int zero = 1 / 0;
  return ResultVO.success();
}
```
## ç±»åˆ©ç”¨
```java

/**
 * æµ‹è¯•
 *
 * @author tnnn
 * @version V1.0
 * @date 2022-07-03 19:36
 */
@Service
@DisposeException(messages ={"é”™è¯¯çš„é›¶","ä¸‹æ ‡è¶Šç•Œ"}, codes = {500,501}, exceptions = {
        ArithmeticException.class,
        ArrayIndexOutOfBoundsException.class} )
public class IService {

    /**
     * å•ä¸ªå¼‚å¸¸
     * @return
     */
    public ResultVO<String> test1(){
        int zero = 1 / 0;
        return ResultVO.success();
    }
    /**
     * å¤šä¸ªå¼‚å¸¸å¤„ç†
     * @return
     */

    public ResultVO<String>  test2(){
        int[] indexs = {1,2,3};
        System.out.println(indexs[4]);
        return ResultVO.success();
    }
}
```
## å¸¸ç”¨å¼‚å¸¸è¯´æ˜
| å¼‚å¸¸å

 | ä½œç”¨

 | å¤‡æ³¨

 |
| --- | --- | --- |
| SQLIntegrityConstraintViolationException

 | **æ•°æ®é‡å¤ï¼ˆå­˜åœ¨å”¯ä¸€ç´¢å¼•ï¼‰**

 | å±äº DataIntegrityViolationException å¼‚å¸¸é‡Œçš„ä¸€ä¸ªcase

 |
| MysqlDataTruncation

 | **åˆ—çš„å€¼è¶…å‡ºèŒƒå›´ **

 | å±äº DataIntegrityViolationException å¼‚å¸¸é‡Œçš„ä¸€ä¸ªcase

 |
| ClassNotFoundException

 | **æ²¡æœ‰æ‰¾åˆ°ç±»**

 |  |
| IOException

 | **IOå¼‚å¸¸**

 |  |
| ArrayIndexOutOfBoundsException

 | **ä¸‹æ ‡è¶Šç•Œ**

 |  |
| NullPointerException

 | **ç©ºæŒ‡é’ˆå¼‚å¸¸**

 |  |

## æ•ˆæœ
![](https://cdn.nlark.com/yuque/0/2022/png/1642320/1656064280207-9c99427e-b75a-4e9e-a95d-8cf491ec6aab.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_14%2Ctext_dGFu%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10#averageHue=%23dcdcdc&from=url&id=QlQfC&originHeight=127&originWidth=480&originalType=binary&ratio=0.8999999761581421&rotation=0&showTitle=false&status=done&style=none&title=)
![](https://cdn.nlark.com/yuque/0/2022/png/1642320/1656855511941-d67f878c-74b9-4b1e-ae18-f8345e0fd236.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_14%2Ctext_dGFu%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10#averageHue=%23c8c8c8&from=url&id=gQQca&originHeight=34&originWidth=486&originalType=binary&ratio=0.8999999761581421&rotation=0&showTitle=false&status=done&style=none&title=)
```http
### å•ä¸ªå¼‚å¸¸
GET http://localhost:8111/a

### å¤šä¸ªå¼‚å¸¸å¤„ç† - 1
GET http://localhost:8111/b?i=1
### å¤šä¸ªå¼‚å¸¸å¤„ç† - 2
GET http://localhost:8111/b?i=2


### å…¨éƒ¨å…¬ç”¨é»˜è®¤code - 1
GET http://localhost:8111/c?i=1
### å…¨éƒ¨å…¬ç”¨é»˜è®¤code - 2
GET http://localhost:8111/c?i=2

### æµ‹è¯•æ³¨è§£åœ¨ç±»ä¸Š - 1
GET http://localhost:8111/e


### æµ‹è¯•æ³¨è§£åœ¨ç±»ä¸Š - 2
GET http://localhost:8111/f
```
```json
http://localhost:8111/a

HTTP/1.1 200 
tlogTraceId: 1540271301946658816
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Fri, 24 Jun 2022 09:51:09 GMT
Keep-Alive: timeout=60
Connection: keep-alive

{
  "code": 500,
  "message": "é”™è¯¯çš„é›¶",
  "data": null,
  "ts": 1656064269900,
  "traceId": "1540271301946658816",
  "success": false
}
å“åº”æ–‡ä»¶å·²ä¿å­˜ã€‚
> 2022-06-24T175110.200.json

Response code: 200; Time: 7ms; Content length: 108 bytes




http://localhost:8111/b?i=1

HTTP/1.1 200 
tlogTraceId: 1540269365272924160
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Fri, 24 Jun 2022 09:43:28 GMT
Keep-Alive: timeout=60
Connection: keep-alive

{
  "code": 500,
  "message": "é”™è¯¯çš„é›¶",
  "data": null,
  "ts": 1656063808161,
  "traceId": "1540269365272924160",
  "success": false
}
å“åº”æ–‡ä»¶å·²ä¿å­˜ã€‚
> 2022-06-24T174328.200.json

Response code: 200; Time: 28ms; Content length: 108 bytes


http://localhost:8111/b?i=2

HTTP/1.1 200 
tlogTraceId: 1540269318305107968
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Fri, 24 Jun 2022 09:43:16 GMT
Keep-Alive: timeout=60
Connection: keep-alive

{
  "code": 501,
  "message": "ä¸‹æ ‡è¶Šç•Œ",
  "data": null,
  "ts": 1656063796963,
  "traceId": "1540269318305107968",
  "success": false
}
å“åº”æ–‡ä»¶å·²ä¿å­˜ã€‚
> 2022-06-24T174317.200.json

Response code: 200; Time: 9ms; Content length: 108 bytes




http://localhost:8111/c?i=1

HTTP/1.1 200 
tlogTraceId: 1540269489399156736
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Fri, 24 Jun 2022 09:43:57 GMT
Keep-Alive: timeout=60
Connection: keep-alive

{
  "code": 500,
  "message": "é”™è¯¯çš„é›¶",
  "data": null,
  "ts": 1656063837755,
  "traceId": "1540269489399156736",
  "success": false
}
å“åº”æ–‡ä»¶å·²ä¿å­˜ã€‚
> 2022-06-24T174359.200.json

Response code: 200; Time: 5ms; Content length: 108 bytes


http://localhost:8111/c?i=2

HTTP/1.1 200 
tlogTraceId: 1540269522760650752
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Fri, 24 Jun 2022 09:44:05 GMT
Keep-Alive: timeout=60
Connection: keep-alive

{
  "code": 500,
  "message": "ä¸‹æ ‡è¶Šç•Œ",
  "data": null,
  "ts": 1656063845710,
  "traceId": "1540269522760650752",
  "success": false
}
å“åº”æ–‡ä»¶å·²ä¿å­˜ã€‚
> 2022-06-24T174405.200.json

Response code: 200; Time: 31ms; Content length: 108 bytes


http://localhost:8111/e

HTTP/1.1 200 
tlogTraceId: 1543570432677502976
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Sun, 03 Jul 2022 12:20:43 GMT
Keep-Alive: timeout=60
Connection: keep-alive

{
  "code": 500,
  "message": "é”™è¯¯çš„é›¶",
  "data": null,
  "ts": 1656850843959,
  "traceId": "1543570432677502976",
  "success": false
}
å“åº”æ–‡ä»¶å·²ä¿å­˜ã€‚
> 2022-07-03T202044.200.json

Response code: 200; Time: 17ms; Content length: 108 bytes


http://localhost:8111/f

HTTP/1.1 200 
tlogTraceId: 1543570454013927424
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Sun, 03 Jul 2022 12:20:49 GMT
Keep-Alive: timeout=60
Connection: keep-alive

{
  "code": 501,
  "message": "ä¸‹æ ‡è¶Šç•Œ",
  "data": null,
  "ts": 1656850849046,
  "traceId": "1543570454013927424",
  "success": false
}
å“åº”æ–‡ä»¶å·²ä¿å­˜ã€‚
> 2022-07-03T202049.200.json

Response code: 200; Time: 16ms; Content length: 108 bytes
```
